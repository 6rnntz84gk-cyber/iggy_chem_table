<!DOCTYPE html>
<html lang="en">
<head><head>
    <!-- Standard favicon -->
    <link rel="icon" href="favicon.ico" sizes="any">
    <!-- For modern browsers (PNG, SVG are preferred) -->
    <link rel="icon" type="png" sizes="96x96" href="favicon-96x96.png">
    <!-- For Apple devices -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
</head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACS | Full Configuration Explorer</title>
    <style>
        :root {
            --bg: #ffffff; --text: #1a1a1a; --card: #ffffff; --border: #000000;
            --primary: #00468b; --overlay: rgba(15, 23, 42, 0.6);
            /* ACS Official Color Palette */
            --alkali: #f9d423; --alkaline: #f39200; --transition: #009ee3;
            --post-trans: #9ea1a3; --metalloid: #546e7a; --nonmetal: #e3004f;
            --halogen: #00b5e2; --noble: #92278f; --lanthanide: #f05a28; --actinide: #00a651;
        }
        [data-theme="dark"] {
            --bg: #0b0e14; --text: #f0f0f0; --card: #1c1f26; --border: #444;
            --overlay: rgba(0,0,0,0.85);
        }

        body, html {
            margin: 0; padding: 0; height: 100vh; width: 100vw;
            font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
            background: var(--bg); color: var(--text);
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* Centered Header Legend */
        .legend {
            display: flex; justify-content: center; align-items: center;
            gap: 12px; padding: 10px; flex-wrap: wrap; 
            background: var(--bg); border-bottom: 1px solid var(--border);
            font-size: 0.65rem; font-weight: bold;
        }
        .leg-item { display: flex; align-items: center; gap: 4px; }
        .swatch { width: 12px; height: 12px; border-radius: 2px; border: 1px solid #000; }

        /* Absolute Center Table */
        .viewport {
            flex: 1; display: flex; justify-content: center; align-items: center;
            padding: 10px; box-sizing: border-box;
        }

        #periodic-table {
            display: grid; grid-template-columns: repeat(18, 1fr);
            grid-template-rows: repeat(10, 1fr); gap: 4px;
            width: auto; height: auto; max-width: 95vw; max-height: 82vh;
        }

        .element {
            aspect-ratio: 1 / 1; width: 52px;
            border: 1px solid var(--border); border-radius: 6px;
            display: flex; flex-direction: column; padding: 3px; cursor: pointer;
            transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            justify-content: space-between; box-sizing: border-box;
            background: var(--card); color: #000;
        }

        .element:hover { transform: scale(1.45); z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 2px solid #000; }
        .el-num { font-size: 0.55rem; font-weight: bold; }
        .el-sym { font-size: 1.1rem; font-weight: 900; text-align: center; line-height: 1; }
        .el-mass { font-size: 0.45rem; text-align: center; font-weight: bold; }

        /* Modal & Detail Pane */
        .overlay {
            position: fixed; inset: 0; background: var(--overlay); backdrop-filter: blur(10px);
            display: none; justify-content: center; align-items: center; z-index: 2000;
        }
        .modal {
            background: var(--card); width: 90%; max-width: 850px;
            border-radius: 20px; padding: 30px; display: grid;
            grid-template-columns: 1fr 1.3fr; gap: 30px; border: 1px solid var(--border);
        }
        .viz-box { 
            background: #000; border-radius: 15px; aspect-ratio: 1/1; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 2px solid #333;
        }
        canvas { width: 100%; height: 100%; }

        .info-pane h2 { margin: 0; font-size: 2.4rem; font-weight: 900; }
        .tag { display: inline-block; padding: 4px 12px; font-size: 0.7rem; font-weight: bold; text-transform: uppercase; margin: 8px 0; border: 1px solid #000; color: #000; }
        
        .stats-box { background: rgba(0,0,0,0.05); padding: 15px; border-radius: 12px; margin: 15px 0; }
        .stat-line { margin-bottom: 10px; }
        .stat-line label { display: block; font-size: 0.6rem; color: var(--primary); font-weight: 900; text-transform: uppercase; }
        .stat-line span { font-weight: 700; font-size: 0.95rem; line-height: 1.4; word-break: break-all; }
        .config-text { font-family: 'Courier New', Courier, monospace; letter-spacing: 0.5px; color: var(--text); }

        .ion-shelf { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 10px; }
        .ion-pill { background: #eee; border: 1px solid #bbb; padding: 5px 12px; border-radius: 6px; font-size: 0.8rem; font-weight: bold; cursor: pointer; color: #000; }
        .ion-pill:hover { background: var(--primary); color: white; }
        
        .theme-switch { position: fixed; bottom: 15px; right: 15px; }
        #theme-btn { padding: 10px 20px; border-radius: 50px; cursor: pointer; font-weight: bold; background: var(--primary); color: white; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

<div class="legend" id="legend"></div>

<div class="viewport">
    <div id="periodic-table"></div>
</div>

<div class="theme-switch"><button id="theme-btn" onclick="toggleTheme()">üåì TOGGLE MODE</button></div>

<div class="overlay" id="overlay">
    <div class="modal">
        <div class="viz-box">
            <canvas id="atom-canvas" width="400" height="400"></canvas>
            <div id="e-label" style="color: #48cae4; font-family: monospace; font-size: 0.9rem; margin-top: 10px;"></div>
        </div>
        <div class="info-pane">
            <h2 id="m-name" style="margin:0;"></h2>
            <div id="m-cat" class="tag"></div>
            
            <div class="stats-box">
                <div class="stat-line">
                    <label>Full Electronic Configuration</label>
                    <span id="m-full-config" class="config-text"></span>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="stat-line"><label>Atomic Mass</label><span id="m-mass"></span></div>
                    <div class="stat-line"><label>Oxidation States</label><span id="m-ions-txt"></span></div>
                </div>
            </div>

            <label style="font-size: 0.65rem; font-weight: 900; color: var(--primary);">BOHR MODEL ION STATE:</label>
            <div class="ion-shelf" id="m-ions-btns"></div>

            <p id="m-use" style="font-size: 0.85rem; line-height: 1.5; margin-top: 20px; opacity: 0.8; font-style: italic;"></p>
            <button onclick="closeModal()" style="width: 100%; padding: 12px; background: #222; color: white; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; margin-top: 15px;">CLOSE EXPLORER</button>
        </div>
    </div>
</div>

<script>
    const symbols = ["","H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"];

    // Precise scientific data for key elements + Generative Logic for others
    const elementLibrary = {
        1: {m:"1.008", i:[0, 1, -1], u:"The most abundant element; fuel for stars."},
        6: {m:"12.011", i:[0, 4, 2, -4], u:"Basis of all life and organic chemistry."},
        11: {m:"22.989", i:[0, 1], u:"Vital for nerve signals and table salt."},
        19: {m:"39.098", i:[0, 1], u:"Potassium: Crucial electrolyte for biological cells."},
        20: {m:"40.078", i:[0, 2], u:"Calcium: Essential for bone structure and cement."},
        25: {m:"54.938", i:[0, 2, 3, 4, 6, 7], u:"Manganese: Essential for hardening steel alloys."},
        26: {m:"55.845", i:[0, 2, 3, 6], u:"Iron: Most common element on earth by mass."},
        79: {m:"196.97", i:[0, 1, 3], u:"Gold: Highly prized for jewelry and electronics."},
        92: {m:"238.03", i:[0, 3, 4, 5, 6], u:"Uranium: High-density fuel for nuclear fission."}
    };

    // --- FULL CONFIGURATION ENGINE ---
    function getFullConfig(n) {
        const order = [
            {s:"1s", m:2}, {s:"2s", m:2}, {s:"2p", m:6}, {s:"3s", m:2}, {s:"3p", m:6},
            {s:"4s", m:2}, {s:"3d", m:10}, {s:"4p", m:6}, {s:"5s", m:2}, {s:"4d", m:10},
            {s:"5p", m:6}, {s:"6s", m:2}, {s:"4f", m:14}, {s:"5d", m:10}, {s:"6p", m:6},
            {s:"7s", m:2}, {s:"5f", m:14}, {s:"6d", m:10}, {s:"7p", m:6}
        ];
        
        // Exceptions handling (Chromium, Copper, Silver, Gold, etc.)
        const exceptions = {
            24: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 4s¬π 3d‚Åµ",
            29: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 4s¬π 3d¬π‚Å∞",
            47: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 4s¬≤ 3d¬π‚Å∞ 4p‚Å∂ 5s¬π 4d¬π‚Å∞",
            79: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 4s¬≤ 3d¬π‚Å∞ 4p‚Å∂ 5s¬≤ 4d¬π‚Å∞ 5p‚Å∂ 6s¬π 4f¬π‚Å¥ 5d¬π‚Å∞"
        };
        if(exceptions[n]) return exceptions[n];

        let res = [];
        let rem = n;
        for (let orb of order) {
            if (rem <= 0) break;
            let take = Math.min(rem, orb.m);
            res.push(`${orb.s}${toSuperscript(take)}`);
            rem -= take;
        }
        return res.join(" ");
    }

    function toSuperscript(num) {
        const map = {"0":"‚Å∞","1":"¬π","2":"¬≤","3":"¬≥","4":"‚Å¥","5":"‚Åµ","6":"‚Å∂","7":"‚Å∑","8":"‚Å∏","9":"‚Åπ"};
        return num.toString().split('').map(c => map[c] || c).join('');
    }

    const categories = { alkali:"Alkali Metal", alkaline:"Alkaline Earth", transition:"Transition Metal", "post-trans":"Post-Transition", metalloid:"Metalloid", nonmetal:"Nonmetal", noble:"Noble Gas", halogen:"Halogen", lanthanide:"Lanthanide", actinide:"Actinide" };

    let ionDiff = 0, animId;
    const ctx = document.getElementById('atom-canvas').getContext('2d');

    function init() {
        const leg = document.getElementById('legend');
        Object.entries(categories).forEach(([k,v]) => leg.innerHTML += `<div class="leg-item"><div class="swatch" style="background:var(--${k})"></div>${v}</div>`);

        const table = document.getElementById('periodic-table');
        for(let n=1; n<=118; n++) {
            let r, c, cat = "transition";
            
            // Standard IUPAC Placement
            if(n === 1) { r=1; c=1; cat="nonmetal"; }
            else if(n === 2) { r=1; c=18; cat="noble"; }
            else if(n >= 57 && n <= 71) { r=9; c=n-53; cat="lanthanide"; }
            else if(n >= 89 && n <= 103) { r=10; c=n-85; cat="actinide"; }
            else {
                if(n<=10) r=2; else if(n<=18) r=3; else if(n<=36) r=4;
                else if(n<=54) r=5; else if(n<=86) r=6; else r=7;

                const rowStarts = [0,1,3,11,19,37,55,87];
                c = n - rowStarts[r] + 1;
                if(r === 2 || r === 3) { if(c > 2) c += 10; }
                if(r === 6 && n >= 72) c -= 14;
                if(r === 7 && n >= 104) c -= 14;

                if(c === 1) cat = "alkali";
                else if(c === 2) cat = "alkaline";
                else if(c === 17) cat = "halogen";
                else if(c === 18) cat = "noble";
                else if([5,14,32,33,51,52,84].includes(n)) cat = "metalloid";
                else if(c >= 13 && c <= 16) {
                    if(n < 11 || n === 15 || n === 16 || n === 34) cat = "nonmetal";
                    else cat = "post-trans";
                }
            }

            const data = elementLibrary[n] || { m:(n*2.1).toFixed(1), i:[0, 2, 3], u:"Scientific laboratory research element." };
            
            const div = document.createElement('div');
            div.className = 'element';
            div.style.gridRow = r; div.style.gridColumn = c;
            div.style.background = `var(--${cat})`;
            div.innerHTML = `<span class="el-num">${n}</span><span class="el-sym">${symbols[n]}</span><span class="el-mass">${data.m}</span>`;
            div.onclick = () => openModal(n, cat, data);
            table.appendChild(div);
        }
    }

    function openModal(n, cat, data) {
        ionDiff = 0;
        document.getElementById('overlay').style.display = 'flex';
        document.getElementById('m-name').innerText = symbols[n] + " (" + n + ")";
        document.getElementById('m-cat').innerText = categories[cat];
        document.getElementById('m-cat').style.background = `var(--${cat})`;
        document.getElementById('m-full-config').innerText = getFullConfig(n);
        document.getElementById('m-mass').innerText = data.m;
        document.getElementById('m-ions-txt').innerText = data.i.join(", ");
        document.getElementById('m-use').innerText = data.u;

        const shelf = document.getElementById('m-ions-btns');
        shelf.innerHTML = '';
        data.i.forEach(i => {
            const b = document.createElement('div'); b.className = 'ion-pill';
            b.innerText = i === 0 ? "Neutral" : (i > 0 ? `+${i}` : i);
            b.onmouseover = () => ionDiff = -i;
            b.onmouseleave = () => ionDiff = 0;
            shelf.appendChild(b);
        });
        startAtom(n);
    }

    function closeModal() { document.getElementById('overlay').style.display='none'; cancelAnimationFrame(animId); }

    function startAtom(protons) {
        let t = 0;
        function draw() {
            ctx.clearRect(0,0,400,400);
            const eCount = Math.max(0, protons + ionDiff);
            document.getElementById('e-label').innerText = `Protons: ${protons} | Electrons: ${eCount}`;
            
            ctx.beginPath(); ctx.arc(200,200,24,0,Math.PI*2); ctx.fillStyle="#e3004f"; ctx.fill();
            ctx.fillStyle="white"; ctx.font="bold 16px sans-serif"; ctx.textAlign="center";
            ctx.fillText(protons + "+", 200, 206);

            const shells = [2, 8, 18, 32, 50]; let rem = eCount;
            shells.forEach((max, i) => {
                if(rem <= 0) return;
                const count = Math.min(rem, max); rem -= count;
                const rad = 65 + (i * 35);
                ctx.beginPath(); ctx.arc(200,200,rad,0,Math.PI*2); ctx.strokeStyle="rgba(255,255,255,0.2)"; ctx.stroke();
                for(let j = 0; j < count; j++) {
                    const rot = t * (1 - i*0.1) + (j * Math.PI * 2 / count);
                    ctx.beginPath(); ctx.arc(200 + Math.cos(rot)*rad, 200 + Math.sin(rot)*rad, 6, 0, Math.PI*2);
                    ctx.fillStyle="#48cae4"; ctx.fill();
                }
            });
            t += 0.02; animId = requestAnimationFrame(draw);
        }
        draw();
    }

    function toggleTheme() {
        const d = document.body.getAttribute('data-theme') === 'dark';
        document.body.setAttribute('data-theme', d ? 'light' : 'dark');
    }

    window.onclick = (e) => { if(e.target === document.getElementById('overlay')) closeModal(); }
    init();
</script>
</body>
</html>
